{% extends "base.html" %}
{% load static %}
{% block body_content %}

<div class="w-full">
        {% include 'slider.html' %}
</div>

<div  id="searchBox" class="flex justify-center items-center mt-16 md:mt-8 md:ml-0 xl:mt-8 xl:ml-0 ">

     <form action="{% url 'items:search' %}" class ="flex  flex-wrap justify-center  w-2/5 md:w-3/5" method="POST">
     {% csrf_token %}
     {% for cate in categories %}
             <button class="text-xl mr-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
              <a href="{% url 'items:filter-by-cate' cate.pk %}" class="p-4">
                 {{cate.name}}</a>
            </button>


     {% endfor %}
      <input type="text" name="searchBar" id="searchBar" placeholder="Tìm kiếm sản phẩm" class=" text-center p-2 text-black ml-2" >
         <button type="submit" id="search" value ="Tìm"  class="btn btn-active btn-primary ml-1" >Search</button>
     </form>
 </div>



{#List item #}
 <div class="max-w-2xl mx-auto py-16 px-4 sm:py-24 sm:px-6 lg:max-w-7xl lg:px-8" >
<div class="mt-1 grid grid-cols-1 gap-y-10 gap-x-6 sm:grid-cols-2 lg:grid-cols-4 xl:gap-x-8 bg-grey-400 ">

{% for item in items %}
    <a href="{% url 'items:details' item.slug %}" class="">
     {% if item.image %}
 <div class="group relative">
  <div class="col-span-5 md:col-span-2 xl:col-span-2 2xl:col-span-2 m-2 mt-4 md:mt-8 flex flex-col items-center  max-w-sm mx-auto">
        <img class="object-contain w-full h-64 bg-gray-300 bg-center bg-cover rounded-lg shadow-md " src="{{item.image.url}}" alt="product"/>
{% endif %}
        <div class="w-56 -mt-8 overflow-hidden bg-white rounded-lg shadow-lg md:w-56 dark:bg-gray-800">
            <h3 class="py-2 font-bold tracking-wide text-center text-gray-800 uppercase dark:text-white">
                <label class="text-xl text-center text-gray-600 font-semibold  border-b-2">{{item.name}}</label><br>

            </h3>

            <div class="flex items-center justify-between px-3 py-2 bg-gray-200 dark:bg-gray-700">
                <span class="font-bold text-gray-800 dark:text-gray-200">{% if item.discount_price %}
                              <label class="text-2xl text-center text-black font-semibold">{{item.item_formated_discount_price}}</label>
                              <del class="text-lg text-center text-red-500 font-semibold">{{item.item_formated_price}}</del>
                              {% else %}
                              <label class="text-xl text-center text-black font-semibold">{{item.item_formated_price}}</label>
                              {% endif %}</span>
                <button id="card_open"  class="px-2 py-1 text-xs font-semibold text-white uppercase transition-colors duration-200 transform bg-gray-800 rounded hover:bg-gray-700 dark:hover:bg-gray-600 focus:bg-gray-700 dark:focus:bg-gray-600 focus:outline-none">Chi tiết </button>
            </div>

        </div>

    </div>
    </div>
          </a>
{% endfor %}
</div>
</div>

    <div>
    {% if page_obj.has_next %}
    <a class="infinite-more-link" href="?page={{ page_obj.next_page_number }}">next</a>
    {% endif %}
  </div>
  <div class="loading" style="display: none;">
    Loading...
  </div>
    <!--Div infinite scroll-->


{% endblock body_content %}
{% block script %}


<script>
  //Get the button
  var mybutton = document.getElementById("btnToTop");
  var mybutton2 = document.getElementById("btnToTop2");
  
  // When the user scrolls down 20px from the top of the document, show the button
  window.onscroll = function() {scrollFunction()};
  
  function scrollFunction() {
    if (document.body.scrollTop > 500 || document.documentElement.scrollTop > 500) {
      mybutton.style.display = "block";
      mybutton2.style.display = "block";
    } else {
      mybutton.style.display = "none";
      mybutton2.style.display = "none";
    }
  }
  
  // When the user clicks on the button, scroll to the top of the document
  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }
  </script>

<script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
  <script src="{% static 'js/infinite.min.js' %}"></script>
  <script>
    var infinite = new Waypoint.Infinite({
            element: $('.infinite-container')[0],
            onBeforePageLoad: function () {
                // $('.loading').show();
            },
            onAfterPageLoad: function () {
                // $('.loading').hide();
            }
        });
  </script>
<script>
        $(function () {
            var availableTags = [
                {% for item in items %}
            "{{item.name}}",
            {% endfor %}
    ];
        $("#searchBar").autocomplete({
            source: availableTags
        });
  } );
    </script>
{% endblock script %}